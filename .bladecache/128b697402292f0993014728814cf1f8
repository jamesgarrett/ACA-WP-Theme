<? $locations = array(); // init multi-map data?>
<section class="grid">
	<div class="row huge-box title-item p-v">

		<?php if (isset($title)): ?>
			<h1 class="title-txt txt-brand"><?php echo $title; ?></h1>
		<?php else: ?>
			<h1 class="title-txt txt-brand">Distributors</h1>
		<?php endif; ?>

		<?php if (isset($content)): ?>
			<?php echo $content; ?>
		<?php endif; ?>

	</div>
	<ul class="list-attachment row">
		<? $i=0; ?>
		<?php $bladequery = new WP_Query(array('post_type' => 'distributors')); if ( $bladequery->have_posts() ) : while ( $bladequery->have_posts() ) : $bladequery->the_post(); ?> 
		<? $i++; ?>
		<?php if (!isset($current) || $current!==$post->ID): ?>
		<a class="cell span-4" title="<?php echo the_title(); ?>" href="<?php echo the_permalink(); ?>">
			<li data-swatch="<?php echo get_field('dist_swatch');; ?>">
				<aside class="attachment">
					<img src="<?php echo get_field("dist_logo",$post->id)["url"]; ?>" alt="<?php echo the_title(); ?>">
				</aside>
				<h1 class="oswald fw-b"><?php echo the_title(); ?></h1>
			</li>
			<? $r = (sqrt(rand(1,1.5))); $r = $i%3==0? -1*$r : abs($r); $r=$r.'deg'; ?>
			<style>
				[data-swatch="<?php echo get_field('dist_swatch');; ?>"] * {
					position: relative;
					z-index: 1;
					color:<?php echo get_field('dist_swatch'); ?>;
					-webkit-transition: color .25s ease-in-out; -o-transition: color .25s ease-in-out;
					transition: color .25s ease-in-out;
				}
				[data-swatch="<?php echo get_field('dist_swatch');; ?>"]:hover * {
					color: #111;
					-webkit-transition: color .25s ease-in-out; -o-transition: color .25s ease-in-out;
					transition: color .25s ease-in-out;
				}
				[data-swatch="<?php echo get_field('dist_swatch');; ?>"]:before {
					content: '.';
					position: absolute; top: 0; left: 0; z-index: 0;
					width: 100%; height: 100%;
					font-size: 0; color: transparent;
					opacity: 0; background-color: transparent;
					-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform: rotate(0deg);
					transform: rotate(0deg);
					-webkit-transition: all .25s ease-in-out; -o-transition: all .25s ease-in-out;
					transition: all .25s ease-in-out;
				}
				[data-swatch="<?php echo get_field('dist_swatch');; ?>"]:hover:before {
					-webkit-transform:rotate(<?php echo  $r ; ?>); -ms-transform:rotate(<?php echo  $r ; ?>);-o-transform:rotate(<?php echo  $r ; ?>);
					transform: rotate(<?php echo  $r ; ?>);
					-webkit-transition: all .25s ease-in-out; -o-transition: all .25s ease-in-out;
					transition: all .25s ease-in-out;
					opacity: 1; background: <?php echo  get_field("dist_swatch") ; ?>;
				}
			</style>
			<?php echo jsl(get_the_title()); ?>
			<? array_push($locations,array(
				"title"       => get_the_title($post->ID),
				"map"         => get_field('dist_location'),
				"description" => get_field('dist_description')
			)); ?>
		</a>
		<?php endif; ?>
		<?php endwhile; ?><?php else: ?>
			<div class="bgc-err"><?php echo  __('This is a distributorless world!') ; ?></div>
		<?php endif; wp_reset_postdata(); ?>
	</ul>
</section>
<?php if (!on_home()): ?>
	<?php echo view('partials.acf-map-multiple',$locations)->with(get_defined_vars())->render(); ?>
<?php endif; ?>